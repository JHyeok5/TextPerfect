"use strict";(self.webpackChunktextperfect=self.webpackChunktextperfect||[]).push([[721],{82721:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var l=a(96540),r=a(80113),n=a(3469),s=a(61409);const c=()=>{const{user:e,isAuthenticated:t}=(0,r.b)(),[a,c]=(0,l.useState)([]),[m,o]=(0,l.useState)([]),[i,d]=(0,l.useState)(null),[g,u]=(0,l.useState)(!0),[x,E]=(0,l.useState)(null),[b,f]=(0,l.useState)(!1),[y,p]=(0,l.useState)("");(0,l.useEffect)(()=>{t&&N()},[t]);const N=async()=>{try{u(!0);const[e,t,a]=await Promise.all([fetch("/.netlify/functions/get-challenges"),fetch("/.netlify/functions/get-leaderboard"),fetch("/.netlify/functions/get-user-stats",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})]);if(e.ok){const t=await e.json();c(t.challenges||[])}if(t.ok){const e=await t.json();o(e.leaderboard||[])}if(a.ok){const e=await a.json();d(e.stats||null)}}catch(e){console.error("Failed to load community data:",e),s.b.error("커뮤니티 데이터를 불러오는데 실패했습니다.")}finally{u(!1)}};return t?g?l.createElement("div",{className:"flex items-center justify-center min-h-96"},l.createElement(n.e,null)):l.createElement("div",{className:"max-w-6xl mx-auto p-6 space-y-8"},l.createElement("div",{className:"text-center"},l.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-2"},"TextPerfect 커뮤니티"),l.createElement("p",{className:"text-gray-600"},"함께 글쓰기 실력을 향상시키고 성과를 공유해보세요")),i&&l.createElement(n.b,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white"},l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6"},l.createElement("div",{className:"text-center"},l.createElement("div",{className:"text-2xl font-bold"},i.documentsThisMonth),l.createElement("div",{className:"text-blue-100"},"이번 달 문서")),l.createElement("div",{className:"text-center"},l.createElement("div",{className:"text-2xl font-bold"},i.averageScore,"점"),l.createElement("div",{className:"text-blue-100"},"평균 점수")),l.createElement("div",{className:"text-center"},l.createElement("div",{className:"text-2xl font-bold"},"#",i.rank),l.createElement("div",{className:"text-blue-100"},"전체 순위")),l.createElement("div",{className:"text-center"},l.createElement("div",{className:"text-2xl font-bold"},i.badges),l.createElement("div",{className:"text-blue-100"},"획득 배지")))),l.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},l.createElement("div",{className:"lg:col-span-2"},l.createElement(n.b,null,l.createElement("div",{className:"flex items-center justify-between mb-6"},l.createElement("h2",{className:"text-xl font-bold text-gray-800"},"🏆 현재 진행 중인 챌린지"),l.createElement(n.a,{variant:"outline",onClick:()=>f(!0)},"성과 공유하기")),l.createElement("div",{className:"space-y-4"},a.length>0?a.map(e=>l.createElement("div",{key:e.id,className:"border rounded-lg p-4 hover:bg-gray-50 transition"},l.createElement("div",{className:"flex items-start justify-between"},l.createElement("div",{className:"flex-1"},l.createElement("h3",{className:"font-semibold text-gray-800 mb-2"},e.title),l.createElement("p",{className:"text-gray-600 text-sm mb-3"},e.description),l.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500"},l.createElement("span",null,"참여자: ",e.participants,"명"),l.createElement("span",null,"기간: ",e.duration),l.createElement("span",null,"보상: ",e.reward))),l.createElement("div",{className:"ml-4"},e.joined?l.createElement("div",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm"},"참여 중"):l.createElement(n.a,{size:"sm",onClick:()=>(async e=>{try{(await fetch("/.netlify/functions/join-challenge",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({challengeId:e})})).ok?(s.b.success("챌린지에 참여했습니다!"),N()):s.b.error("챌린지 참여에 실패했습니다.")}catch(e){console.error("Failed to join challenge:",e),s.b.error("챌린지 참여 중 오류가 발생했습니다.")}})(e.id)},"참여하기"))),e.joined&&e.progress&&l.createElement("div",{className:"mt-4"},l.createElement("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1"},l.createElement("span",null,"진행률"),l.createElement("span",null,e.progress.current,"/",e.progress.target)),l.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2"},l.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.progress.current/e.progress.target*100,"%")}}))))):l.createElement("div",{className:"text-center py-8 text-gray-500"},"현재 진행 중인 챌린지가 없습니다.")))),l.createElement("div",null,l.createElement(n.b,null,l.createElement("h2",{className:"text-xl font-bold text-gray-800 mb-6"},"🥇 이번 달 리더보드"),l.createElement("div",{className:"space-y-3"},m.length>0?m.map((e,t)=>l.createElement("div",{key:e.id,className:"flex items-center gap-3 p-3 rounded-lg ".concat(t<3?"bg-gradient-to-r from-yellow-50 to-orange-50":"bg-gray-50")},l.createElement("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ".concat(0===t?"bg-yellow-500 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-600 text-white":"bg-gray-200 text-gray-600")},t+1),l.createElement("div",{className:"flex-1"},l.createElement("div",{className:"font-medium text-gray-800"},e.nickname,e.id===(null==e?void 0:e.id)&&l.createElement("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},"나")),l.createElement("div",{className:"text-sm text-gray-500"},e.documents,"개 문서 • 평균 ",e.averageScore,"점")),l.createElement("div",{className:"text-right"},l.createElement("div",{className:"font-bold text-gray-800"},e.totalScore,"점"),t<3&&l.createElement("div",{className:"text-xs text-orange-600"},"🏆 배지 획득")))):l.createElement("div",{className:"text-center py-8 text-gray-500"},"리더보드 데이터가 없습니다."))))),l.createElement(n.f,{open:b,onClose:()=>f(!1),title:"성과 공유하기"},l.createElement("div",{className:"space-y-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"공유할 내용을 작성해주세요"),l.createElement("textarea",{value:y,onChange:e=>p(e.target.value),placeholder:"오늘의 글쓰기 성과나 팁을 공유해보세요...",className:"w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})),l.createElement("div",{className:"flex items-center gap-3"},l.createElement(n.a,{variant:"outline",onClick:()=>f(!1)},"취소"),l.createElement(n.a,{variant:"primary",onClick:async()=>{try{(await fetch("/.netlify/functions/share-analysis",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({content:y,type:"achievement"})})).ok?(s.b.success("분석 결과를 공유했습니다!"),f(!1),p("")):s.b.error("공유에 실패했습니다.")}catch(e){console.error("Failed to share analysis:",e),s.b.error("공유 중 오류가 발생했습니다.")}},disabled:!y.trim()},"공유하기"))))):l.createElement("div",{className:"max-w-4xl mx-auto p-6"},l.createElement(n.b,{className:"text-center py-12"},l.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-4"},"커뮤니티 참여하기"),l.createElement("p",{className:"text-gray-600 mb-6"},"로그인하여 글쓰기 챌린지에 참여하고 다른 사용자들과 경쟁해보세요!"),l.createElement(n.a,{variant:"primary"},"로그인하기")))}}}]);